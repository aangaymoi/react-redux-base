{"version":3,"sources":["../source/server.ts"],"names":["log","server","http","createServer","rest","PORT","process","env","startup","listen","cleanup","error","close","exit","graceful","callback","on"],"mappings":"uoJAGMA,CAAAA,GAAG,CAAG,mBAAM,YAAN,C,CAKNC,MAAM,CAAGC,cAAKC,YAAL,CAAkBC,aAAlB,C,CAEFC,IAAI,CAAGC,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAAqB,M,mBAElC,KAAMG,CAAAA,OAAO,CAAG,SAAY,CACjC,KAAM,uBAD2B,CAEjC,KAAMP,CAAAA,MAAM,CAACQ,MAAP,CAAcJ,IAAd,CAF2B,CAGjCL,GAAG,CAAE,gCAA+BK,IAAK,EAAtC,CACJ,CAJM,C,wBAMA,KAAMK,CAAAA,OAAO,CAAG,KAAOC,CAAAA,CAAP,EAAqC,CAC1D,KAAM,0BADoD,CAE1D,KAAMV,CAAAA,MAAM,CAACW,KAAP,EAFoD,CAG1DZ,GAAG,CAAE,wBAAuBK,IAAK,UAA9B,CAHuD,CAI1DC,OAAO,CAACO,IAAR,CAAaF,CAAK,CAAG,CAAH,CAAO,CAAzB,CACD,CALM,C,wBAOPH,OAAO,E,CAEA,KAAMM,CAAAA,QAAQ,CAAG,KAAOC,CAAAA,CAAP,EAAoD,CAC1ET,OAAO,CAACU,EAAR,CAAW,kBAAX,CAA+BD,CAA/B,CAD0E,CAE1ET,OAAO,CAACU,EAAR,CAAW,mBAAX,CAAgCD,CAAhC,CAF0E,CAG1ET,OAAO,CAACU,EAAR,CAAW,QAAX,CAAqBD,CAArB,CACD,CAJM,C,0BAMPD,QAAQ,CAACJ,OAAD,C,cAEOT,M","sourcesContent":["import 'core-js'\r\n\r\nimport debug from 'debug'\r\nconst log = debug('api:server')\r\n\r\nimport { connect, disconnect } from './repo/database'\r\nimport http from 'http'\r\nimport rest from './rest'\r\nconst server = http.createServer(rest)\r\n\r\nexport const PORT = process.env.PORT || `3000`\r\n\r\nexport const startup = async () => {\r\n  await connect()\r\n  await server.listen(PORT)\r\n  log(`Application started on port: ${PORT}`)\r\n}\r\n\r\nexport const cleanup = async (error: any): Promise<void> => {\r\n  await disconnect()\r\n  await server.close()\r\n  log(`Application on port: ${PORT} stopped`)\r\n  process.exit(error ? 1 : 0)\r\n}\r\n\r\nstartup()\r\n\r\nexport const graceful = async (callback: (error?: any) => Promise<void>) => {\r\n  process.on('rejectionHandled', callback)\r\n  process.on('uncaughtException', callback)\r\n  process.on('SIGINT', callback)\r\n}\r\n\r\ngraceful(cleanup)\r\n\r\nexport default server\r\n"],"file":"server.js"}