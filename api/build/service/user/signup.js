"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Signup=void 0;var _debug=_interopRequireDefault(require("debug")),_authorize=require("../authorize"),_controller=require("../controller"),_validator=require("validator"),_hash=_interopRequireDefault(require("../../tool/hash")),_user=_interopRequireDefault(require("../../repo/user"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}const log=(0,_debug.default)("api:service:user:signup");class Signup{constructor(){_defineProperty(this,"handle",async(a,b)=>{const{name:c,email:d,password:e}=a.body,f=[];if(c||f.push(`"name" is missing`),d||f.push(`"email" is missing`),d&&!(0,_validator.isEmail)(d)&&f.push(`"email" is not valid`),e||f.push(`"password" is missing`),f.length){const c=await this.format(a.get("X-Device"),a.get("X-Locate"),!1,{errors:f});return b.status(400).send(c)}const g=await _user.default.create({type:"user",name:c,email:d,password:(0,_hash.default)(e)});if(!g){const c=await this.format(a.get("X-Device"),a.get("X-Locate"),!1,{errors:["Conflict"]});return b.status(409).send(c)}const h=await this.format(a.get("X-Device"),a.get("X-Locate"),!0,{user:g});return b.status(200).send(h)}),_defineProperty(this,"format",async(a,b,c,d)=>{switch(a){// case 'mobile':
// case 'tablet':
case"desktop":default:switch(b){case"en-US":default:return{success:c,payload:d};}}})}}exports.Signup=Signup;const signup=new _controller.Controller(new _authorize.None(),new Signup());var _default=signup;exports.default=_default;
//# sourceMappingURL=signup.js.map