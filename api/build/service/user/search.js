"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Search=void 0;var _debug=_interopRequireDefault(require("debug")),_authorize=require("../authorize"),_controller=require("../controller"),_user=_interopRequireDefault(require("../../repo/user"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}const log=(0,_debug.default)("api:service:user:search");class Search{constructor(){_defineProperty(this,"handle",async(a,b)=>{let{name:c,email:d,exact:e,order:f,offset:g,limit:h}=a.query;const i=[];if(c||d||i.push(`"name" or "email" must be specified`),c&&d&&i.push(`only "name" or "email" can be specified`),i.length){const c=await this.format(a.get("X-Device"),a.get("X-Locate"),!1,{errors:i});return b.status(400).send(c)}if(e="true"===e,f="asc"===f?"asc":"desc",h=0<=parseInt(h)?parseInt(h):10,g=0<=parseInt(g)?parseInt(g):0,c){const d=await _user.default.search("name",c,{exact:e,order:f,limit:h,offset:g}),i=await this.format(a.get("X-Device"),a.get("X-Locate"),!0,{users:d});return b.status(200).send(i)}if(d){const c=await _user.default.search("email",d,{exact:e,order:f,limit:h,offset:g}),i=await this.format(a.get("X-Device"),a.get("X-Locate"),!0,{users:c});return b.status(200).send(i)}}),_defineProperty(this,"format",(a,b,c,d)=>{switch(a){// case 'mobile':
// case 'tablet':
case"desktop":default:switch(b){case"en-US":default:return Promise.resolve({success:c,payload:d});}}})}}exports.Search=Search;const search=new _controller.Controller(new _authorize.Admin(),new Search());var _default=search;exports.default=_default;
//# sourceMappingURL=search.js.map