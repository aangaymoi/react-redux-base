"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logged=exports.Admin=exports.None=void 0;var _debug=_interopRequireDefault(require("debug")),_uuid=_interopRequireDefault(require("uuid")),_user=_interopRequireDefault(require("../repo/user"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}const log=(0,_debug.default)("api:service:authorize");class None{constructor(){_defineProperty(this,"check",async()=>(0,_uuid.default)())}}exports.None=None;class Admin{constructor(){_defineProperty(this,"check",async a=>{const b=await _user.default.search("uuid",a,{exact:!0},`and ((current_timestamp - datetime(strftime(last_access))) / 3600000) < 2 `);if(b&&"admin"===b.type){const a=await _user.default.refresh(b._id);return a.uuid}})}}exports.Admin=Admin;class Logged{constructor(){_defineProperty(this,"check",async a=>{const b=await _user.default.search("uuid",a,{exact:!0},`and ((current_timestamp - datetime(strftime(last_access))) / 3600000) < 2 `);if(b&&"user"===b.type){const a=await _user.default.refresh(b._id);return a.uuid}})}}exports.Logged=Logged;
//# sourceMappingURL=authorize.js.map